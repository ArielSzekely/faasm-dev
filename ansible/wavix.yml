---

- hosts: localhost
  gather_facts: no
  tasks:
    - name: "System deps"
      become: yes
      apt:
        name: "{{ item }}"
        state: "present"
      with_items:
        - build-essential
        - python
        - gcc
        - g++
        - ninja-build

    - name: "Clone wavix"
      git:
        repo: "https://github.com/WAVM/Wavix.git"
        dest: "/usr/local/code/Wavix"

    - name: "Create build dir"
      file:
        path: "/usr/local/code/WavixBuild"
        state: directory

    - name: "Run build"
      shell: "python /usr/local/code/Wavix/bootstrap/build.py"
      args:
        chdir: "/usr/local/code/WavixBuild"